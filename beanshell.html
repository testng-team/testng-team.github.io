<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.18">
<title>BeanShell and advanced group selection</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="./asciidoctor.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
</head>
<body class="article toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel2">
<li><a href="#_beanshell_and_advanced_group_selection">BeanShell and advanced group selection</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect2">
<h3 id="_beanshell_and_advanced_group_selection">BeanShell and advanced group selection</h3>
<div class="paragraph">
<p>If the <code>&lt;include&gt;</code> and <code>&lt;exclude&gt;</code> tags in <code>testng.xml</code> are not enough for your needs, you can use a <a href="https://beanshell.org/">BeanShell</a> expression to decide whether a certain test method should be included in a test run or not. You specify this expression just under the <code>&lt;test&gt;</code> tag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;test name="BeanShell test"&gt;
   &lt;method-selectors&gt;
     &lt;method-selector&gt;
       &lt;script language="beanshell"&gt;
            &lt;![CDATA[
                    groups.containsKey("test1")
            ]]&gt;
        &lt;/script&gt;
     &lt;/method-selector&gt;
   &lt;/method-selectors&gt;
  &lt;!-- ... --&gt;
&lt;/test&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>When a <code>&lt;script&gt;</code> tag is found in testng.xml, TestNG will ignore subsequent <code>&lt;include&gt;</code> and <code>&lt;exclude&gt;</code> of groups and methods in the current <code>&lt;test&gt;</code> tag:  your BeanShell expression will be the only way to decide whether a test method is included or not.</p>
</div>
<div class="paragraph">
<p>Here are additional information on the BeanShell script:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It must return a boolean value.  Except for this constraint, any valid BeanShell code is allowed (for example, you might want to return <code>true</code> during week days and <code>false</code> during weekends, which would allow you to run tests differently depending on the date).</p>
</li>
<li>
<p>TestNG defines the following variables for your convenience:</p>
<div class="ulist">
<ul>
<li>
<p><code>java.lang.reflect.Method method</code>: the current test method.</p>
</li>
<li>
<p><code>org.testng.ITestNGMethod testngMethod</code>: the description of the current test method.</p>
</li>
<li>
<p><code>java.util.Map&lt;String, String&gt; groups</code>: a map of the groups the current test method belongs to.</p>
</li>
</ul>
</div>
</li>
<li>
<p>You might want to surround your expression with a CDATA declaration (as shown above) to avoid tedious quoting of reserved XML characters).</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Starting from version <code>7.5</code> TestNG does not bring in any dependency on BeanShell implementations by default.
So in order to leverage BeanShell based method selectors, please remember to add an explicit dependency on BeanShell.
For example <a href="https://mvnrepository.com/artifact/org.apache-extras.beanshell/bsh">org.apache-extras.beanshell</a>
</td>
</tr>
</table>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-02-27 18:51:48 UTC
</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js"></script>
</body>
</html>